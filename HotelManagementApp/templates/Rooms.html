{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Skyline Resort – Rooms</title>
  <link rel="stylesheet" type="text/css" href="{% static 'css/rooms.css' %}">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js" integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO" crossorigin="anonymous"></script>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top shadow-sm">
  <div class="container-fluid">
    <a class="navbar-brand" href="{% url 'login' %}"><img src="{% static 'images/hotelLogo.png' %}" height="60px" width="60px"></a>
    <div class="collapse navbar-collapse justify-content-end" id="navbarContent">
      <ul class="navbar-nav align-items-center">
        <li class="nav-item">
          <a class="nav-link fw-semibold" href="{% url 'my_bookings' %}">My Bookings</a>
        </li>
        <li class="nav-item ms-3">
          <a class="nav-link" href="{% url 'profile' %}" title="Your Profile">
            <img src="https://cdn-icons-png.flaticon.com/512/149/149071.png"
                 alt="Profile" width="32" height="32" style="border-radius: 50%;">
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

  <div class="container">
    <div class="row" id="roomsGrid">
    {% for room in rooms %}
      <div class="col-sm-6 col-lg-4 mb-4" data-price="{{ room.price_per_day }}">
        <div class="room-card card h-100">
          <img src="{{ room.image.url }}" class="card-img-top" alt="{{ room.name }}">
          <div class="card-body d-flex flex-column">
            <div class="room-name fw-bold">{{ room.name }}</div>
            <p class="text-muted small flex-grow-1">
              {{ room.description|truncatewords:10 }}
            </p>
            {% with room.availability_status as status %}
            {% if "Available now" in status %}
              <p class="text-success fw-bold">{{ status }}</p>
            {% else %}
              <p class="text-warning fw-bold">{{ status }}</p>
            {% endif %}
          {% endwith %}
            <div class="room-price">₹{{ room.price_per_day }} / Day</div>
            <a href="{% url 'booking' room.roomnum %}" class="btn btn-outline-warning m-2">Book Now</a>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
  </div>

  
  <script>
    const sortSelect = document.getElementById('sortSelect');
    const roomsGrid = document.getElementById('roomsGrid');

    sortSelect.addEventListener('change', () => sortRooms(sortSelect.value));

    function sortRooms(order = 'asc') {
      const cardsArray = Array.from(roomsGrid.children);

      cardsArray.sort((a, b) => {
        const priceA = parseFloat(a.getAttribute('data-price'));
        const priceB = parseFloat(b.getAttribute('data-price'));
        return order === 'asc' ? priceA - priceB : priceB - priceA;
      });
      cardsArray.forEach(card => roomsGrid.appendChild(card));
    }
    sortRooms(sortSelect.value);
  </script>
</body>
</html>
